(function() {
  'use strict';
  angular.module('app.home', [
  ])
  .controller('homeCtrl', ['$rootScope', '$scope', 'Fullscreen', function($rootScope, $scope, Fullscreen) {
    $rootScope.menu = ""
    var ctrl = this

    ctrl.scoreTeam1 = 0
    ctrl.scoreTeam2 = 0
    ctrl.round = 1
    ctrl.teamName1 = "SET TEAM NAME 1"
    ctrl.teamName2 = "SET TEAM NAME 2"
    ctrl.timeStatus = "Start"
    ctrl.timerRunning = false;

    ctrl.fouls1 = setDefaultFoul();
    ctrl.fouls2 = setDefaultFoul();

    function setDefaultFoul() {
      return [
        {class: "circle-thin", color: "text-green"},
        {class: "circle-thin", color: "text-green"},
        {class: "circle-thin", color: "text-green"},
        {class: "circle-thin", color: "text-green"},
        {class: "circle-thin", color: "text-red"},
      ]
    }
    
    ctrl.addScore = function(team, score) {
      switch(team) {
        case 1:
          ctrl.scoreTeam1 += score
          break;
        case 2:
          ctrl.scoreTeam2 += score
          break;
      }
    }

    ctrl.resetScore = function(team) {
      switch(team) {
        case 1:
          ctrl.scoreTeam1 = 0
          break;
        case 2:
          ctrl.scoreTeam2 = 0
          break;
      }
    }

    ctrl.timerToggle = function (){
      if (ctrl.timerRunning) {
        $scope.$broadcast('timer-stop');
        ctrl.timeStatus = "Resume"
      } else {
        $scope.$broadcast('timer-start');
        ctrl.timeStatus = "Stop"
      }
      ctrl.timerRunning = !ctrl.timerRunning;
    };

    ctrl.timerReset = function (){
      $scope.$broadcast('timer-reset');
    };
    
    ctrl.nextRound = function() {
      if (ctrl.round >= 0 && ctrl.round < 4) {
        ctrl.round += 1
      }
    }

    ctrl.prevRound = function() {
      if (ctrl.round > 1){
        ctrl.round -= 1
      }
    }

    ctrl.resetRound = function() {
      ctrl.round = 1
      ctrl.timerRunning = false
      ctrl.timeStatus = "Start"
    }

    ctrl.trickFoul = function(fouls, index) {
      fouls.forEach(function(value, i) {
        if (i <= index) {
          fouls[i].class = "circle"
        } else {
          fouls[i].class = "circle-thin"
        }

      })
    }

    ctrl.resetFoul = function(team) {
      switch(team) {
        case 1:
          ctrl.fouls1 = setDefaultFoul();
          break;
        case 2:
          ctrl.fouls2 = setDefaultFoul();
          break;
      }
    }

    ctrl.resetAll = function() {
      ctrl.scoreTeam1 = 0
      ctrl.scoreTeam2 = 0
      ctrl.round = 1
      ctrl.teamName1 = "SET TEAM NAME 1"
      ctrl.teamName2 = "SET TEAM NAME 2"
      ctrl.timeStatus = "Start"
      ctrl.timerRunning = false;

      ctrl.fouls1 = setDefaultFoul();
      ctrl.fouls2 = setDefaultFoul();
      ctrl.timerReset()
    }

    ctrl.fullscreen = function() {
      Fullscreen.all();
    }


  }]);
})();
